# redux-saga

redux-thunk는 함수 형태의 액션을 dispatch하여 미들웨어에서 해당 함수에 스토어의 dispatch와 getState를 파라미터로 넣어서 사용하는 원리이다.

redux-saga는 더 까다로운 상황에서 유용하다.

- 기존 요청을 취소 처리해야할 때 (불필요한 중복 요청 방지)
- 특정 액션이 발생했을 때 다른 액션을 발생시키거나, API 요청 등 리덕스와 관계 없는 코드를 실행할 때
- 웹소켓을 사용할 때
- API 요청 실패 시 재요청해야할 때

## 1. Generator 함수 이해하기

redux-saga에서는 ES6의 제너레이터(generator) 함수라는 문법을 사용한다.

generator 함수 문법의 핵심 기능은 함수를 작성할 때 함수를 특정 구간에 멈춰 놓을 수도 있고, 원할 때 다시 돌아가게 할 수도 있다는 것이다.

```javascript
function weirdFunction() {
    return 1;
    return 2;
    return 3;
    return 4;
    return 5;
}
```

하나의 함수에서 여러 개의 값을 반환하는 것은 불가능하므로 이 코드는 제대로 동작하지 않는다. 1을 반환하고 함수는 종료한다.

그러나 generator 함수를 이용하면 함수에서 값을 순차적으로 반환할 수 있다. 심지어 함수의 흐름을 도중에 멈췄다가 다시 이어서 진행시킬 수도 있다.

```javascript
function* generatorFunction() {
    console.log('안녕하세요');
    yield 1;
    console.log('제너레이터 함수');
    yield 2;
    console.log('function*');
    yield 3;
    return 4;
}
```

함수를 작성한 후에는 다음 코드로 generator를 생성한다.

```javascript
const generator = generatorFunction();
```

generator 함수를 호출했을 때 반환되는 객체를 generator라고 부른다.

`generator.next`로 함수의 흐름을 제어할 수 있다.

![image](https://user-images.githubusercontent.com/48080762/74101349-28c13500-4b7c-11ea-8b04-936fe14fbb4c.png)

1. Generator 처음 생성 시 함수의 흐름은 멈춰있다.
2. next()가 호출되면 다음 `yield`가 있는 곳까지 호출되고 다시 함수가 멈춘다.

next 함수에 파라미터를 넣으면 generator 함수에서 yield를 사용하여 해당 값을 조회할 수도 있다.

